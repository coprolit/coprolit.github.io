import{S as e,i as t,s as n,h as i,c as r,n as a,f as o,e as s,t as m,a as l,d as u,j as c,b as d,k as f,l as p,p as N}from"./main.js";function I(e,t,n){const i=e.slice();return i[3]=t[n],i}function S(e){let t,n,i,a,p,N,S,b,y,g,U,k,w,v,P,A,M,D,T,E=e[1].orderDice+"",O=e[1].points+"",x=e[1].platoons,G=[];for(let t=0;t<x.length;t+=1)G[t]=h(I(e,x,t));return{c(){t=s("div"),n=s("div"),i=m("Order Dice: "),a=m(E),p=l(),N=s("div"),S=m("Total Points: "),b=m(O),y=l();for(let e=0;e<G.length;e+=1)G[e].c();g=l(),U=s("div"),k=l(),w=s("div"),v=l(),P=s("div"),A=l(),M=s("div"),D=l(),T=s("div"),d(t,"class","flow")},m(e,o){r(e,t,o),u(t,n),u(n,i),u(n,a),u(t,p),u(t,N),u(N,S),u(N,b),u(t,y);for(let e=0;e<G.length;e+=1)G[e].m(t,null);u(t,g),u(t,U),u(t,k),u(t,w),u(t,v),u(t,P),u(t,A),u(t,M),u(t,D),u(t,T)},p(e,n){if(2&n&&E!==(E=e[1].orderDice+"")&&c(a,E),2&n&&O!==(O=e[1].points+"")&&c(b,O),2&n){let i;for(x=e[1].platoons,i=0;i<x.length;i+=1){const r=I(e,x,i);G[i]?G[i].p(r,n):(G[i]=h(r),G[i].c(),G[i].m(t,g))}for(;i<G.length;i+=1)G[i].d(1);G.length=x.length}},d(e){e&&o(t),f(G,e)}}}function b(e){let t,n,i;return{c(){t=s("form"),t.innerHTML='<label for="url">Import army:</label> \n\t\t<input type="url" name="url"/> \n\t\t<button type="submit">Submit</button>'},m(a,o){r(a,t,o),n||(i=p(t,"submit",N(e[2])),n=!0)},p:a,d(e){e&&o(t),n=!1,i()}}}function h(e){let t,n,i,a,d,f,p=e[3].name+"",N=e[3].subName+"";return{c(){t=s("div"),n=m(p),i=l(),a=s("h3"),d=m(N),f=l()},m(e,o){r(e,t,o),u(t,n),r(e,i,o),r(e,a,o),u(a,d),u(a,f)},p(e,t){2&t&&p!==(p=e[3].name+"")&&c(n,p),2&t&&N!==(N=e[3].subName+"")&&c(d,N)},d(e){e&&o(t),e&&o(i),e&&o(a)}}}function y(e){let t;function n(e,t){return e[0]?b:S}let s=n(e),m=s(e);return{c(){m.c(),t=i()},m(e,n){m.m(e,n),r(e,t,n)},p(e,[i]){s===(s=n(e))&&m?m.p(e,i):(m.d(1),m=s(e),m&&(m.c(),m.m(t.parentNode,t)))},i:a,o:a,d(e){m.d(e),e&&o(t)}}}function g(e){if(e.SectionName.includes("Artillery"))return 6;if(e.UnitItems[0].ItemMobility){if(e.UnitItems[0].ItemMobility.includes("Wheeled"))return 24;if(e.UnitItems[0].ItemMobility.includes("Tracked"))return 18}return 12}function U(e){return e.SectionName.includes("Infantry")||e.SectionName.includes("Officer")||e.SectionName.includes("Mortar")||e.SectionName.includes("Sniper")||e.SectionName.includes("Anti-tank")||e.SectionName.includes("Artillery")?"Inexperienced"===e.UnitSkill?3:"Regular"===e.UnitSkill?4:"Veteran"===e.UnitSkill?5:4:e.SectionName.includes("Armoured Cars")||e.SectionName.includes("Tanks and SP Guns")?Number(e.UnitItems[0].ItemDamageValue.slice(0,-1)):4}function k(e){return e.SectionName.includes("Infantry")||e.SectionName.includes("Officer")?e.UnitItems.filter(e=>!!e.ItemQuantity).flatMap(e=>w(e)).map(e=>function(e,t){return{name:e.ItemName,weapons:[A(e)]}}(e)):e.SectionName.includes("Mortar")||e.SectionName.includes("Artillery")||e.SectionName.includes("Sniper")||e.SectionName.includes("Anti-tank")?e.UnitItems.filter(e=>!!e.ItemQuantity).map(e=>{let t=0;e.ItemNotes.includes("Spotter")&&(t=1);const n=e.ItemNotes.search(/[0-9]/);return n>-1&&(t=Number(e.ItemNotes.slice(n,n+1))),{...e,ItemQuantity:t}}).flatMap(e=>w(e)).map(v):e.SectionName.includes("Armoured Cars")||e.SectionName.includes("Tanks and SP Guns")?e.UnitItems.filter(e=>"true"===e.IsVehicle).map(t=>{const n=e.UnitItems.filter(e=>"true"===e.IsGun&&e.ItemLine===t.ItemLine);return{name:t.ItemName,weapons:n.flatMap(A)}}):[]}function w(e){return Array.from(Array(e.ItemQuantity)).map(()=>e)}function v(e,t){return{name:e.ItemName,weapons:0===t?[A(e)]:[]}}function P(e){return Number(e.ItemPEN)||Number(e.ItemPen)||("HE"===e.ItemPen||"HE"===e.ItemPEN?(t=e.ItemNotes,Number(t.charAt(t.search(/HE \(/g)+4))):0)||0;var t}function A(e){return{pen:P(e),rof:(n=e.ItemROF,Number(n)?Number(n):n.includes("D6")?1:(n.includes("-"),2)),range:(t=e.ItemRange,"string"==typeof t?0===t.length?12:Number(t.slice(-3,-1)):Number(t)||12)};var t,n}function M(e,t,n){let i,r=!0;return[r,i,async function(e){const t=new FormData(e.target).get("url");try{const e=await fetch("https://www.philippesimpson.dk/armylist.php?url="+t,{method:"GET"});if(!e.ok)throw new Error(e.statusText);const a=await e.json();console.log("result",a),n(0,r=!1),n(1,i=function(e){const t=e.Platoons.map(e=>{const t=e.Units.map(e=>({name:e.UnitName,sectionName:e.SectionName,skill:e.UnitSkill,damageValue:U(e),movement:g(e),models:k(e)}));return{name:e.PlatoonName,subName:e.PlatoonSubName,units:t}});return{orderDice:e.OrderDice,points:e.TotalPoints,platoons:t}}(a)),console.log(i)}catch(e){throw e}}]}export default class extends e{constructor(e){super(),t(this,e,M,y,n,{})}}
//# sourceMappingURL=analyzer-a795dc40.js.map
