import{S as e,i as t,s as n,h as i,c as r,n as a,f as l,e as o,t as s,a as c,d as m,j as u,b as d,k as f,l as N,p}from"./main.js";function I(e,t,n){const i=e.slice();return i[3]=t[n],i}function S(e){let t,n,i,a,N,p,S,h,y,b,w,v,k,P,U,A,E,M,T,x,D,H,O,G=e[1].orderDice+"",F=e[1].points+"",R=JSON.stringify(e[1],null,2)+"",j=e[1].platoons,C=[];for(let t=0;t<j.length;t+=1)C[t]=g(I(e,j,t));return{c(){t=o("div"),n=o("div"),i=s("Order Dice: "),a=s(G),N=c(),p=o("div"),S=s("Total Points: "),h=s(F),y=c();for(let e=0;e<C.length;e+=1)C[e].c();b=c(),w=o("div"),v=o("pre"),k=s(R),P=c(),U=o("div"),A=c(),E=o("div"),M=c(),T=o("div"),x=c(),D=o("div"),H=c(),O=o("div"),d(v,"class","svelte-8pwile"),d(t,"class","flow")},m(e,l){r(e,t,l),m(t,n),m(n,i),m(n,a),m(t,N),m(t,p),m(p,S),m(p,h),m(t,y);for(let e=0;e<C.length;e+=1)C[e].m(t,null);m(t,b),m(t,w),m(w,v),m(v,k),m(t,P),m(t,U),m(t,A),m(t,E),m(t,M),m(t,T),m(t,x),m(t,D),m(t,H),m(t,O)},p(e,n){if(2&n&&G!==(G=e[1].orderDice+"")&&u(a,G),2&n&&F!==(F=e[1].points+"")&&u(h,F),2&n){let i;for(j=e[1].platoons,i=0;i<j.length;i+=1){const r=I(e,j,i);C[i]?C[i].p(r,n):(C[i]=g(r),C[i].c(),C[i].m(t,b))}for(;i<C.length;i+=1)C[i].d(1);C.length=j.length}2&n&&R!==(R=JSON.stringify(e[1],null,2)+"")&&u(k,R)},d(e){e&&l(t),f(C,e)}}}function h(e){let t,n,i;return{c(){t=o("form"),t.innerHTML='<label for="url">Import army:</label> \n\t\t<input type="url" name="url"/> \n\t\t<button type="submit">Submit</button>'},m(a,l){r(a,t,l),n||(i=N(t,"submit",p(e[2])),n=!0)},p:a,d(e){e&&l(t),n=!1,i()}}}function g(e){let t,n,i,a,d,f,N=e[3].name+"",p=e[3].subName+"";return{c(){t=o("div"),n=s(N),i=c(),a=o("h3"),d=s(p),f=c()},m(e,l){r(e,t,l),m(t,n),r(e,i,l),r(e,a,l),m(a,d),m(a,f)},p(e,t){2&t&&N!==(N=e[3].name+"")&&u(n,N),2&t&&p!==(p=e[3].subName+"")&&u(d,p)},d(e){e&&l(t),e&&l(i),e&&l(a)}}}function y(e){let t;function n(e,t){return e[0]?h:S}let o=n(e),s=o(e);return{c(){s.c(),t=i()},m(e,n){s.m(e,n),r(e,t,n)},p(e,[i]){o===(o=n(e))&&s?s.p(e,i):(s.d(1),s=o(e),s&&(s.c(),s.m(t.parentNode,t)))},i:a,o:a,d(e){s.d(e),e&&l(t)}}}function b(e){if(e.SectionName.includes("Artillery"))return 6;if(e.UnitItems[0].ItemMobility){if(e.UnitItems[0].ItemMobility.includes("Wheeled"))return 24;if(e.UnitItems[0].ItemMobility.includes("Tracked"))return 18}return 12}function w(e){return e.SectionName.includes("Infantry")||e.SectionName.includes("Officer")||e.SectionName.includes("Mortar")||e.SectionName.includes("Sniper")||e.SectionName.includes("Anti-tank")||e.SectionName.includes("Artillery")?"Inexperienced"===e.UnitSkill?3:"Regular"===e.UnitSkill?4:"Veteran"===e.UnitSkill?5:4:e.SectionName.includes("Armoured Cars")||e.SectionName.includes("Tanks and SP Guns")?Number(e.UnitItems[0].ItemDamageValue.slice(0,-1)):4}function v(e){return e.SectionName.includes("Infantry")||e.SectionName.includes("Officer")?e.UnitItems.filter(e=>!!e.ItemQuantity).flatMap(k).map(U):e.SectionName.includes("Mortar")||e.SectionName.includes("Artillery")||e.SectionName.includes("Sniper")||e.SectionName.includes("Machine Gun")||e.SectionName.includes("Anti-tank")?e.UnitItems.filter(e=>!!e.ItemQuantity).filter(e=>!e.ItemNotes.includes("Spotter")).flatMap(k).map(U):e.SectionName.includes("Armoured Cars")||e.SectionName.includes("Tanks and SP Guns")?e.UnitItems.filter(e=>"true"===e.IsGun).map(U):[]}function k(e){return Array.from(Array(e.ItemQuantity)).map(()=>e)}function P(e){return Number(e.ItemPEN)||Number(e.ItemPen)||("HE"===e.ItemPen||"HE"===e.ItemPEN?(t=e.ItemNotes,Number(t.charAt(t.search(/HE \(/g)+4))):0)||0;var t}function U(e){return e.ItemName.includes("Infantry (equipped as modeled")?{name:"SMG",pen:0,rof:2,range:12,special:{}}:{name:e.ItemName,pen:P(e),rof:(n=e.ItemROF,Number(n)?Number(n):n.includes("D6")?1:(n.includes("-"),2)),range:(t=e.ItemRange,"string"==typeof t?0===t.length?12:Number(t.slice(-3,-1)):Number(t)||12),special:A(e)};var t,n}function A(e){console.log("getSpecialRules",e);let t={};return"HE"!==e.ItemPen&&"HE"!==e.ItemPEN||(t.HE=!0),e.ItemNotes.includes("Fixed")&&(t.fixed=!0),e.ItemNotes.includes("Indirect")&&(t.indirect=!0),e.ItemNotes.includes("Howitzer")&&(t.howitzer=!0),e.ItemNotes.includes("Flamethrower")&&(t.flamethrower=!0),e.ItemNotes.includes("Team")&&(t.team=!0),e.ItemName.includes("Co-axial")&&(t.coaxial=!0),e.ItemNotes.includes("Front arc")&&(t.arc="front"),e.ItemName.includes("Turret-mounted")&&(t.arc="turret"),t}function E(e,t,n){let i,r=!0;return[r,i,async function(e){const t=new FormData(e.target).get("url");try{const e=await fetch("https://www.philippesimpson.dk/armylist.php?url="+t,{method:"GET"});if(!e.ok)throw new Error(e.statusText);const a=await e.json();console.log("result",a),n(0,r=!1),n(1,i=function(e){const t=e.Platoons.map(e=>{const t=e.Units.map(e=>({name:e.UnitName,sectionName:e.SectionName,skill:e.UnitSkill,damageValue:w(e),movement:b(e),weapons:v(e)}));return{name:e.PlatoonName,subName:e.PlatoonSubName,units:t}});return{orderDice:e.OrderDice,points:e.TotalPoints,platoons:t}}(a)),console.log(i)}catch(e){throw alert("Army list not found."),e}}]}export default class extends e{constructor(e){super(),t(this,e,E,y,n,{})}}
//# sourceMappingURL=analyzer-7d2cc26a.js.map
