{"version":3,"file":"index-f2e2ab5d.js","sources":["../../src/pages/index.svelte"],"sourcesContent":["<!-- routify:options title=\"Generator\" -->\n\n<svelte:head>\n\t<title>Command Post - Your one stop destination for starting up a Bolt Action game.</title>\n\t<meta name=\"google-site-verification\" content=\"6itfOql0q25qkV8Yr7wEi9wcfzwybFKWWcRsdg6567w\" />\n\t<meta name=\"title\" content=\"Command Post - Your one stop destination for starting up a Bolt Action game.\" />\n\t<meta name=\"description\" content=\"A wargame tool for making it easy to choose scenario and assign missions before beginning a game of Bolt Action.\" />\n\t<html lang=\"en\" />\n</svelte:head>\n\n<script>\n    import { metatags, layout, url } from '@roxi/routify';\n    // metatags.title = 'Command Post';\n    // metatags.description = 'Bolt Action Scenario and Missions generator.';\n\n    const emailPattern = \"[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$\";\n\n    let selected;\n    let includeMissions = false;\n    let includeBattleScenarios = false;\n    let includeAttDefScenarios = false;\n    let includeBAAScenarios = false;\n    let scenario = false;\n    let includeConditions = false;\n\n    let send1 = false;\n    let send2 = false;\n\n    function getRandomInt(max) {\n        return Math.floor(Math.random() * Math.floor(max));\n    }\n\n    function generate(event) {\n        // Reset:\n        send1 = false;\n        send2 = false;\n        scenario = false;\n\n        if (includeMissions) {\n            assignMissions(event.target.email1.value, event.target.email2.value);\n        }\n        \n        if (includeBattleScenarios || includeAttDefScenarios || includeBAAScenarios) {\n            scenario = getScenario(includeBattleScenarios, includeAttDefScenarios, includeBAAScenarios);\n        }\n        \n    }\n\n    function assignMissions(email1, email2) {\n        \n        const missions = $layout.parent.children\n            .filter(child => child.path === '/missions')[0]\n            .children\n            .map(child => {\n                return {\n                    path: window.location.href + child.path.slice(1),\n                    title: child.title\n                }\n            });\n\n        // Assign mission to player #1:\n        const randomMission1 = missions[getRandomInt(missions.length - 1)];\n        \n        fetch('https://www.philippesimpson.dk/mail.php', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            mode: 'no-cors', // no-cors, *cors, same-origin\n            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n            credentials: 'omit', // include, *same-origin, omit\n            body: JSON.stringify({\n                to: email1,\n                title: randomMission1.title,\n                path: randomMission1.path\n            })\n        }).then(\n            message => send1 = true\n        );\n        \n        // Assign mission to player #1:\n        const randomMission2 = missions[getRandomInt(missions.length - 1)];\n\n        fetch('https://www.philippesimpson.dk/mail.php', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            mode: 'no-cors', // no-cors, *cors, same-origin\n            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n            credentials: 'omit', // include, *same-origin, omit\n            body: JSON.stringify({\n                to: email2,\n                title: randomMission2.title,\n                path: randomMission2.path\n            })\n        }).then(\n            message => send2 = true\n        );\n    }\n\n    function getScenario(battle, attackerDefender, baa) {\n\n        const battleScenarios = [\n            {\n                title: \"No Man's Land\",\n                info: \"Scenario 1 (Rulebook p.134)\"\n            },\n            {\n                title: \"Meeting Engagement\",\n                info: \"Scenario 2 (Rulebook p.135)\"\n            },\n            {\n                title: \"Key Positions\",\n                info: \"Scenario 3 (Rulebook p.136)\"\n            },\n            {\n                title: \"Double Envelopment\",\n                info: \"Scenario 4 (Rulebook p.137)\"\n            },\n            {\n                title: \"Top Secret\",\n                info: \"Scenario 5 (Rulebook p.138)\"\n            },\n            {\n                title: \"Demolition\",\n                info: \"Scenario 6 (Rulebook p.139)\"\n            }\n        ];\n\n        const attDefScenarios = [\n            {\n                title: \"Envelopment\",\n                info: \"Scenario 7 (Rulebook p.140)\"\n            },\n            {\n                title: \"Manhunt\",\n                info: \"Scenario 8 (Rulebook p.142)\"\n            },\n            {\n                title: \"Point Defence\",\n                info: \"Scenario 9 (Rulebook p.144)\"\n            },\n            {\n                title: \"Hold Until Relieved\",\n                info: \"Scenario 10 (Rulebook p.145)\"\n            },\n            {\n                title: \"Surrounded!\",\n                info: \"Scenario 11 (Rulebook p.146)\"\n            },\n            {\n                title: \"Sectors\",\n                info: \"Scenario 12 (Rulebook p.148)\"\n            }\n        ];\n\n        const baaScenarios = [\n            {\n                title: \"Heartbreak Ridge\",\n                info: \"Bolt Action Alliance 2020 Mission Pack scenario\",\n                link: \"https://drive.google.com/file/d/1FoDzjibgYJzykMLgvqERwBzAuYbH7x2w/view\"\n            },\n            {\n                title: \"Kitty Hawk Down\",\n                info: \"Bolt Action Alliance 2020 Mission Pack scenario\",\n                link: \"https://drive.google.com/file/d/1FoDzjibgYJzykMLgvqERwBzAuYbH7x2w/view\"\n            },\n            {\n                title: \"Nuts!\",\n                info: \"Bolt Action Alliance 2020 Mission Pack scenario\",\n                link: \"https://drive.google.com/file/d/1FoDzjibgYJzykMLgvqERwBzAuYbH7x2w/view\"\n            },\n            {\n                title: \"Break Out\",\n                info: \"Bolt Action Alliance 2020 Mission Pack scenario\",\n                link: \"https://drive.google.com/file/d/1FoDzjibgYJzykMLgvqERwBzAuYbH7x2w/view\"\n            },\n            {\n                title: \"Fog of War\",\n                info: \"Bolt Action Alliance 2020 Mission Pack scenario\",\n                link: \"https://drive.google.com/file/d/1FoDzjibgYJzykMLgvqERwBzAuYbH7x2w/view\"\n            },\n            {\n                title: \"Crossfire\",\n                info: \"Bolt Action Alliance 2020 Mission Pack scenario\",\n                link: \"https://drive.google.com/file/d/1FoDzjibgYJzykMLgvqERwBzAuYbH7x2w/view\"\n            }\n        ];\n\n        let scenarios = [];\n        \n        if (battle) {\n            scenarios = scenarios.concat(battleScenarios);\n        }\n        if (attackerDefender) {\n            scenarios = scenarios.concat(attDefScenarios);\n        }\n        if (baa) {\n            scenarios = scenarios.concat(baaScenarios)\n        }\n\n        return scenarios[getRandomInt(scenarios.length)];\n    }\n\n    function getCondition() {\n        const conditions = [\n            {\n                title: \"Fuel Shortage\",\n                desc: \"Due to prolonged fighting, each player rolls a D6+2 for each of their vehicles, the sum is the player's total Fuel units. Split fuel units between the vehicles and mark down in secret. A Run or Advance order consumes a fuel unit.\"\n            },\n            {\n                title: \"Heavy Rain\",\n                desc: \"Weeklong downpour has made off-road movement difficult even for tanks. All Open Ground is treated as Rough Ground instead.\"\n            },\n            {\n                title: \"Starvation\",\n                desc: \"Food supplies have dwindled away and the men are weak. All infantry loose any Tough Fighter abilities, and Run at D6+6 inch speed.\"\n            },\n            {\n                title: \"Ammunition Shortage\",\n                desc: \"Can only give half of all units a Fire, Advance or Ambush order in a turn. Start of Round 3 there are airdrops incoming. Player choose the drop point and it deviates 4D6 in a random direction. Get in base contact with it = all units can fire, advance or ambush the current and next round.\"\n            },\n        ]\n    }\n</script>\n\n<style>\n\n    img {\n        object-fit: cover;\n        width: 100%;\n        box-shadow: 1px 1px 5px 0 rgba(0,0,0,.5);\n    }\n\n    form {\n        display: grid;\n        gap: var(--spacing);\n    }\n\n    input[type=submit] {\n        width: fit-content;\n        justify-self: center;\n    }\n\n    @media (min-width: 640px) {\n        form {\n            grid-template-columns: 1fr 1fr 1fr;\n        }\n\n        input[type=submit] {\n            grid-column: span 3;\n        }\n    }\n</style>\n\n<h1>Generator</h1>\n\n<p>\n    Select your preferred options below and generate a random game of Bolt Action.\n</p>\n\n<form \n    on:submit|preventDefault={generate}\n    class=\"flex\"\n>\n    <fieldset class=\"border flow\">\n        <legend>\n                <strong>Scenario</strong>\n        </legend>\n        \n        <div>\n            <small><i>Bolt Action 2 Rulebook:</i></small>\n            <div>\n                <input\n                    type=\"checkbox\"\n                    id=\"battle\"\n                    bind:checked={includeBattleScenarios}\n                >\n                <label for=\"battle\"><strong>Battle</strong> scenarios</label>\n            </div>\n        \n            <div>\n                <input\n                    type=\"checkbox\"\n                    id=\"attacker-defender\"\n                    bind:checked={includeAttDefScenarios}\n                >\n                <label for=\"attacker-defender\"><strong>Attacker-Defender</strong> scenarios</label>\n            </div>\n        </div>\n    \n        <div>\n            <small><i>WWPD/Bolt Action Alliance:</i></small>\n            <div>\n                <input\n                    type=\"checkbox\"\n                    id=\"baa-scenarios\"\n                    bind:checked={includeBAAScenarios}\n                >\n                <label for=\"baa-scenarios\"><strong>2020 Mission Pack</strong> scenarios</label>\n            </div>\n        </div>\n        \n        <div class=\"info-box flex\">\n            <div class=\"margin-right-small\">&#9432;</div>\n            <div>Scenarios provide the <strong>main</strong> objective and victory condition for each player.</div>\n        </div>\n    </fieldset>\n    \n    <fieldset class=\"border flow\">\n        <legend>\n            <strong>Secret missions</strong>\n        </legend>\n        \n        <div>\n            <input\n                type=\"checkbox\"\n                id=\"mission\"\n                bind:checked={includeMissions}>\n            <label for=\"mission\">Assign a mission to each player</label>\n\n            {#if includeMissions}\n            <div>\n                <input\n                    type=\"email\"\n                    name=\"email1\"\n                    pattern={emailPattern}\n                    title=\"player 1 email address\"\n                    required\n                    placeholder=\"Player's email\">   \n                vs.\n                <input\n                    type=\"email\"\n                    name=\"email2\"\n                    pattern={emailPattern}\n                    title=\"player 2 email address\"\n                    required\n                    placeholder=\"Player's email\"\n                >\n            </div>\n            <p><small><i>Each player receives their secret mission via email.</i></small></p>\n            {/if}\n        </div>\n\n        <div class=\"info-box flex\">\n            <div class=\"margin-right-small\">&#9432;</div>\n            <div>Missions add a <strong>secondary</strong> objective for each player.<br> Achieving a mission objective helps the player towards winning the played Scenario.</div>\n        </div>\n    </fieldset>\n\n    <fieldset class=\"border flow color-inactive\">\n        <legend><small>Battlefield Condition</small></legend>\n        <div>\n            <input\n                disabled\n                type=\"checkbox\"\n                id=\"condition\"\n                bind:checked={includeConditions}>\n            <label for=\"mission\">50% of an unusual Battlefield Condition taking effect</label>\n        </div>\n        <div class=\"info-box flex\">\n            <div class=\"margin-right-small\">&#9432;</div>\n            <div>Battlefield Conditions are gameplay modifying rules applying for both players.</div>\n        </div>\n    </fieldset> \n    \n    <input\n        type=\"submit\"\n        value=\"Generate\" />\n</form>\n\n{#if scenario}\n<div class=\"padding flow border panel shadow\">   \n    <div>\n        You are to face your opponent in:\n    </div>\n    \n    <h3>{scenario.title}</h3>\n    {scenario.info}\n    {#if scenario.link}\n    <div>\n        Get scenario <strong><a href=\"{scenario.link}\" target=\"_blank\">here</a></strong>\n    </div>\n    {/if}    \n\n</div>\n{/if}\n\n{#if send1 && send2}\n<div class=\"padding flow border panel shadow\">\n    Secret missions have been assigned and send to each player. <span class=\"check-mark\">&check;</span>\n</div>\n{/if}\n\n<img src=\"/images/lpkb2gkaw4s51.jpg\" alt=\"mission briefing\" />\n"],"names":["emailPattern","ctx","title","info","link","getRandomInt","max","Math","floor","random","includeMissions","includeBattleScenarios","includeAttDefScenarios","includeBAAScenarios","scenario","includeConditions","send1","send2","event","email1","email2","missions","$layout","parent","children","filter","child","path","map","window","location","href","slice","randomMission1","length","fetch","method","headers","Content-Type","mode","cache","credentials","body","JSON","stringify","to","then","message","randomMission2","assignMissions","target","value","battle","attackerDefender","baa","battleScenarios","attDefScenarios","baaScenarios","scenarios","concat","getScenario"],"mappings":"8ZAkU6BA,kJAQAA,2NA2CpBC,KAASC,WACbD,KAASE,UACLF,KAASG,uSAFTH,KAASC,+BACbD,KAASE,iBACLF,KAASG,gNAEqBH,KAASG,+FAATH,KAASG,4bA5D/BH,aAkDZA,cAiBAA,MAASA,2zGAhHoBA,kDASAA,uEAYAA,uFAqBJA,6HAuCAA,0PA/FAA,yCAcIA,sBASAA,sBAYAA,uBAqBJA,MAGbA,uFAoCaA,MAczBA,gFAiBAA,MAASA,mPAjXJD,EAAe,iDAaZK,EAAaC,UACXC,KAAKC,MAAMD,KAAKE,SAAWF,KAAKC,MAAMF,oDAX7CI,GAAkB,EAClBC,GAAyB,EACzBC,GAAyB,EACzBC,GAAsB,EACtBC,GAAW,EACXC,GAAoB,EAEpBC,GAAQ,EACRC,GAAQ,kCAMMC,OAEdF,GAAQ,OACRC,GAAQ,OACRH,GAAW,GAEPJ,YAUgBS,EAAQC,SAEtBC,EAAWC,EAAQC,OAAOC,SAC3BC,OAAOC,GAAwB,cAAfA,EAAMC,MAAsB,GAC5CH,SACAI,IAAIF,KAEGC,KAAME,OAAOC,SAASC,KAAOL,EAAMC,KAAKK,MAAM,GAC9C9B,MAAOwB,EAAMxB,SAKnB+B,EAAiBZ,EAAShB,EAAagB,EAASa,OAAS,IAE/DC,MAAM,2CACFC,OAAQ,OACRC,SAAWC,eAAgB,oBAC3BC,KAAM,UACNC,MAAO,WACPC,YAAa,OACbC,KAAMC,KAAKC,WACPC,GAAI1B,EACJjB,MAAO+B,EAAe/B,MACtByB,KAAMM,EAAeN,SAE1BmB,KACCC,OAAW/B,GAAQ,UAIjBgC,EAAiB3B,EAAShB,EAAagB,EAASa,OAAS,IAE/DC,MAAM,2CACFC,OAAQ,OACRC,SAAWC,eAAgB,oBAC3BC,KAAM,UACNC,MAAO,WACPC,YAAa,OACbC,KAAMC,KAAKC,WACPC,GAAIzB,EACJlB,MAAO8C,EAAe9C,MACtByB,KAAMqB,EAAerB,SAE1BmB,KACCC,OAAW9B,GAAQ,IAtDnBgC,CAAe/B,EAAMgC,OAAO/B,OAAOgC,MAAOjC,EAAMgC,OAAO9B,OAAO+B,QAG9DxC,GAA0BC,GAA0BC,QACpDC,WAsDasC,EAAQC,EAAkBC,SAErCC,IAEErD,MAAO,gBACPC,KAAM,gCAGND,MAAO,qBACPC,KAAM,gCAGND,MAAO,gBACPC,KAAM,gCAGND,MAAO,qBACPC,KAAM,gCAGND,MAAO,aACPC,KAAM,gCAGND,MAAO,aACPC,KAAM,gCAIRqD,IAEEtD,MAAO,cACPC,KAAM,gCAGND,MAAO,UACPC,KAAM,gCAGND,MAAO,gBACPC,KAAM,gCAGND,MAAO,sBACPC,KAAM,iCAGND,MAAO,cACPC,KAAM,iCAGND,MAAO,UACPC,KAAM,iCAIRsD,IAEEvD,MAAO,mBACPC,KAAM,kDACNC,KAAM,2EAGNF,MAAO,kBACPC,KAAM,kDACNC,KAAM,2EAGNF,MAAO,QACPC,KAAM,kDACNC,KAAM,2EAGNF,MAAO,YACPC,KAAM,kDACNC,KAAM,2EAGNF,MAAO,aACPC,KAAM,kDACNC,KAAM,2EAGNF,MAAO,YACPC,KAAM,kDACNC,KAAM,+EAIVsD,YAEAN,IACAM,EAAYA,EAAUC,OAAOJ,IAE7BF,IACAK,EAAYA,EAAUC,OAAOH,IAE7BF,IACAI,EAAYA,EAAUC,OAAOF,IAG1BC,EAAUrD,EAAaqD,EAAUxB,SA3JzB0B,CAAYjD,EAAwBC,EAAwBC,gBAqOjDF,kCASAC,kCAYAC,kCAqBJH,kCAuCAK"}