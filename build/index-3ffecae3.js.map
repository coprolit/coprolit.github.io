{"version":3,"file":"index-3ffecae3.js","sources":["../../src/pages/index.svelte"],"sourcesContent":["<script>\n    import { metatags, layout, url } from '@roxi/routify';\n    metatags.title = 'Mission generator';\n    metatags.description = 'Description coming soon...';\n\n    const emailPattern = \"[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$\";\n\n    let selected;\n    let includeMissions = false;\n    let includeBattleScenarios = false;\n    let includeAttDefScenarios = false;\n    let scenario = false;\n\n    let send1 = false;\n    let send2 = false;\n\n    function getRandomInt(max, min = 0) {\n        return Math.floor(Math.random() * (max - min + 1) + min);\n    }\n\n    function generate(event) {\n        // Reset:\n        send1, send2, scenario = false;\n\n        if (includeMissions) {\n            assignMissions(event.target.email1.value, event.target.email2.value);\n        }\n        \n        if (includeBattleScenarios || includeAttDefScenarios) {\n            scenario = getScenario(includeBattleScenarios, includeAttDefScenarios);\n        }\n        \n    }\n\n    function assignMissions(email1, email2) {\n        \n        const missions = $layout.parent.children\n            .filter(child => child.path === '/missions')[0]\n            .children\n            .map(child => {\n                return {\n                    path: window.location.href + child.path.slice(1),\n                    title: child.title\n                }\n            });\n\n        // Assign mission to player #1:\n        const randomMission1 = missions[getRandomInt(missions.length - 1)];\n        \n        Email.send({\n            SecureToken: \"0b6eed09-ca2b-41ed-9283-2d33686b5dd2\",\n            To: email1,\n            From: \"missions@philippesimpson.dk\",\n            Subject: \"You have been assigned the mission: \" + randomMission1.title,\n            Body: `See your mission <a href=${randomMission1.path}>here</a>`\n        }).then(\n            message => send1 = true\n        );\n        \n        // Assign mission to player #1:\n        const randomMission2 = missions[getRandomInt(missions.length - 1)];\n\n        Email.send({\n            SecureToken: \"0b6eed09-ca2b-41ed-9283-2d33686b5dd2\",\n            To: email2,\n            From: \"missions@philippesimpson.dk\",\n            Subject: \"You have been assigned the mission: \" + randomMission2.title,\n            Body: `See your mission <a href=${randomMission2.path}>here</a>`\n        }).then(\n            message => send2 = true\n        );\n    }\n\n    function getScenario(battle, attackerDefender) {\n\n        const scenarios = [\n            \"Scenario 1 – No Man's Land (Rulebook p.134)\",\n            \"Scenario 2 – Meeting Engagement (Rulebook p.135)\",\n            \"Scenario 3 – Key Positions (Rulebook p.136)\",\n            \"Scenario 4 – Double Envelopment (Rulebook p.137)\",\n            \"Scenario 5 – Top Secret (Rulebook p.138)\",\n            \"Scenario 6 – Demolition (Rulebook p.139)\",\n            \"Scenario 7 – Envelopment (Rulebook p.140)\",\n            \"Scenario 8 – Manhunt (Rulebook p.142)\",\n            \"Scenario 9 – Point Defence (Rulebook p.144)\",\n            \"Scenario 10 – Hold Until Relieved (Rulebook p.145)\",\n            \"Scenario 11 – Surrounded! (Rulebook p.146)\",\n            \"Scenario 12 – Sectors (Rulebook p.148)\"\n        ]\n\n        if (battle && attackerDefender) {\n            return scenarios[getRandomInt(11)];\n        }\n\n        if (battle) {\n            return scenarios[getRandomInt(5)];\n        }\n\n        if (attackerDefender) {\n            return scenarios[getRandomInt(11, 6)];\n        }\n    }\n</script>\n\n<!-- routify:options title=\"Main\" -->\n\n<svelte:head>\n    <script src=\"https://smtpjs.com/v3/smtp.js\"></script>\n</svelte:head>\n\n<style>\n    img {\n        object-fit: cover;\n        width: 100%;\n        box-shadow: 1px 1px 5px 0 rgba(0,0,0,.5);\n    }\n</style>\n\n<img src=\"/images/lpkb2gkaw4s51.jpg\" alt=\"mission briefing\" />\n\n<h1>Assign objectives</h1>\n\n<p>\n    Randomly assign scenario and/or secret missions:\n</p>\n\n<div class=\"shadow padding flow border\">\n    <form \n        on:submit|preventDefault={generate}\n        class=\"flow\"\n    >\n        <div>\n            <div>\n                <input\n                    type=\"checkbox\"\n                    id=\"battle\"\n                    bind:checked={includeBattleScenarios}\n                >\n                <label for=\"battle\">Rulebook Battle scenarios</label>\n            </div>\n            <div>\n                <input\n                    type=\"checkbox\"\n                    id=\"attacker-defender\"\n                    bind:checked={includeAttDefScenarios}\n                >\n                <label for=\"attacker-defender\">Rulebook Attacker-Defender scenarios</label>\n            </div>\n        </div>\n        <div>\n            <input\n                type=\"checkbox\"\n                id=\"mission\"\n                bind:checked={includeMissions}>\n            <label for=\"mission\">Secret missions</label>\n\n            {#if includeMissions}\n            <div>\n                <input\n                    type=\"email\"\n                    name=\"email1\"\n                    pattern={emailPattern}\n                    title=\"player 1 email address\"\n                    required\n                    placeholder=\"Player's email\">   \n                vs.\n                <input\n                    type=\"email\"\n                    name=\"email2\"\n                    pattern={emailPattern}\n                    title=\"player 2 email address\"\n                    required\n                    placeholder=\"Player's email\"\n                >\n            </div>\n            {/if}\n        </div>\n        \n        <div>\n            <input\n                type=\"submit\"\n                value=\"Generate\">\n        </div>\n    </form>\n\n    {#if scenario}\n    <div class=\"border-top\"></div>\n    <div>\n        You are to face your opponent in:\n    </div>\n    <blockquote>{scenario}</blockquote>\n    {/if}\n    {#if (send1 && send2)}\n    <div class=\"border-top\"></div>\n    <div>\n        Secret missions have been assigned and send to each player. <span class=\"check-mark\">&check;</span>\n    </div>\n    {/if}\n</div>\n\n\n"],"names":["emailPattern","ctx","getRandomInt","max","min","Math","floor","random","metatags","title","description","includeMissions","includeBattleScenarios","includeAttDefScenarios","scenario","send1","send2","event","email1","email2","missions","$layout","parent","children","filter","child","path","map","window","location","href","slice","randomMission1","length","Email","send","SecureToken","To","From","Subject","Body","then","message","randomMission2","assignMissions","target","value","battle","attackerDefender","scenarios","getScenario"],"mappings":"wUAgK6BA,kJAQAA,wSAqBZC,6GAAAA,sZAlCAA,YA6BRA,aAOCA,MAASA,2tCAxDeA,kDAQAA,kDASJA,kLAzBIA,wCAQAA,sBAQAA,sBASJA,MAGbA,6DA6BRA,2DAOCA,MAASA,qLA1LTD,EAAe,iDAWZE,EAAaC,EAAKC,EAAM,UACtBC,KAAKC,MAAMD,KAAKE,UAAYJ,EAAMC,EAAM,GAAKA,+CAfxDI,EAASC,MAAQ,oBACjBD,EAASE,YAAc,iCAKnBC,GAAkB,EAClBC,GAAyB,EACzBC,GAAyB,EACzBC,GAAW,EAEXC,GAAQ,EACRC,GAAQ,8BAMMC,OAEAH,GAAW,GAErBH,YAUgBO,EAAQC,SAEtBC,EAAWC,EAAQC,OAAOC,SAC3BC,OAAOC,GAAwB,cAAfA,EAAMC,MAAsB,GAC5CH,SACAI,IAAIF,KAEGC,KAAME,OAAOC,SAASC,KAAOL,EAAMC,KAAKK,MAAM,GAC9CtB,MAAOgB,EAAMhB,SAKnBuB,EAAiBZ,EAASlB,EAAakB,EAASa,OAAS,IAE/DC,MAAMC,MACFC,YAAa,uCACbC,GAAInB,EACJoB,KAAM,8BACNC,QAAS,uCAAyCP,EAAevB,MACjE+B,iCAAkCR,EAAeN,kBAClDe,KACCC,OAAW3B,GAAQ,UAIjB4B,EAAiBvB,EAASlB,EAAakB,EAASa,OAAS,IAE/DC,MAAMC,MACFC,YAAa,uCACbC,GAAIlB,EACJmB,KAAM,8BACNC,QAAS,uCAAyCI,EAAelC,MACjE+B,iCAAkCG,EAAejB,kBAClDe,KACCC,OAAW1B,GAAQ,IA5CnB4B,CAAe3B,EAAM4B,OAAO3B,OAAO4B,MAAO7B,EAAM4B,OAAO1B,OAAO2B,QAG9DlC,GAA0BC,QAC1BC,WA4CaiC,EAAQC,SAEnBC,GACF,8CACA,mDACA,8CACA,mDACA,2CACA,2CACA,4CACA,wCACA,8CACA,qDACA,6CACA,iDAGAF,GAAUC,EACHC,EAAU/C,EAAa,KAG9B6C,EACOE,EAAU/C,EAAa,IAG9B8C,EACOC,EAAU/C,EAAa,GAAI,WAtEvBgD,CAAYtC,EAAwBC,gBA0GzBD,kCAQAC,kCASJF"}